<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>在Spring Boot中使用Redis</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="canonical" href="/2016/10/12/%E5%9C%A8Spring-Boot%E4%B8%AD%E4%BD%BF%E7%94%A8Redis/">
	<link rel="alternate" type="application/rss+xml" title="阳光如初." href="/feed.xml">

	<meta name="description" content="阳光如初;sunshineasbefore;个人博客;怀揣梦想,永不止步;">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?94be4b0f9fc5d94cc0d0415ea6761ae9";
		  var s = document.getElementsByTagName("script")[0];
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>


  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">
        <li>
          <a href="/">主页</a>
        </li>
        <li>
          <a href="/categories/">分类</a>
        </li>
        <li>
          <a href="/tag">标签</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="https://github.com/sunshineasbefore">Github</a>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>在Spring Boot中使用Redis</h1>
		    <p>Post on Oct 12, 2016 by <a href="/about">sunshineasbefore</a></p>
		-->
		    <h3>怀揣梦想,永不止步!</h3>
    
  </div>
</div>

    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#Spring-Boot-ref">Spring-Boot</a>	/
    	<a href="/tag/#Spring Boot-ref">Spring Boot</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
<!--
    
      
      
      
      

      
        <li><a href="#year_2016">2016</a>
          <ul class="nav">
            <li><a href="#month_2016_October">October</a></li>
      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_September">September</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_August">August</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            </ul>
          </li>
      
    
-->
  </ul>
</div> 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">在Spring Boot中使用Redis</h1>
              <!--
                <p class="post-meta">Oct 12, 2016</p>
              -->
              <div class="meta">Posted on <span class="postdate">Oct 12, 2016</span> By <a target="_blank" href="http://www.veryjava.cn">sunshineasbefore</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#redis" id="markdown-toc-redis">Redis简介</a></li>
  <li><a href="#linuxredis" id="markdown-toc-linuxredis">Linux下Redis安装(单机)</a></li>
  <li><a href="#redis-1" id="markdown-toc-redis-1">编译并安装Redis</a></li>
  <li><a href="#spring-boot-redis" id="markdown-toc-spring-boot-redis">Spring Boot 连接Redis</a></li>
</ul>

<h1 id="redis">Redis简介</h1>

<p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。 它支持多种类型的数据结构，如 字符串（strings）， 散列（hashes）， 列表（lists）， 集合（sets）， 有序集合（sorted sets） 与范围查询， bitmaps， hyperloglogs 和 地理空间（geospatial） 索引半径查询。 Redis 内置了 复制（replication），LUA脚本（Lua scripting）， LRU驱动事件（LRU eviction），事务（transactions） 和不同级别的 磁盘持久化（persistence）， 并通过 Redis哨兵（Sentinel）和自动 分区（Cluster）提供高可用性（high availability）。</p>

<blockquote>
  <p><a href="http://www.redis.cn/">Redis中国用户组</a></p>
</blockquote>

<h1 id="linuxredis">Linux下Redis安装(单机)</h1>

<ul>
  <li>
    <p>下载<a href="http://www.redis.cn/download.html">Redis3.2.3版本</a>并解压</p>

    <p><code class="highlighter-rouge">bash
wget http://download.redis.io/releases/redis-3.2.3.tar.gz
</code></p>

    <p><code class="highlighter-rouge">bash
tar -zxf redis-3.2.3.tar.gz ./
</code></p>
  </li>
</ul>

<h1 id="redis-1">编译并安装Redis</h1>

<ul>
  <li>
    <p>编译Redis</p>

    <p><code class="highlighter-rouge">bash
cd xx/redis-3.2.3
</code></p>

    <p><code class="highlighter-rouge">bash
make
</code></p>
  </li>
  <li>
    <p>启动Redis</p>

    <ul>
      <li>
        <p>Redis配置文件redis.conf在根目录下,其中有很多默认配置和详细说明.在此就不全贴出来了.</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>#修改redis是否已守护进程的方式运行 yes则启动守护进程
daemonize no

#redis以守护进程运行时 制定其pidfile文件
pidfile /var/run/redis.pid

#Redis端口号,默认6379
port 6379

#客户端闲置超时时间,0则表示关闭该功能
timeout 300

#日志记录级别，Redis共支持四个级别：debug、verbose、notice、warning，默认为verbose
loglevel verbose

#日志输出方式,默认为标准输出,即输出到控制台;如果redis以守护进程的方式运行,在这个地方配置标准输出的话,则会将日志发送给/dev/null,即什么都看不到
logfile stdout

#数据库的数量,默认为0,可以使用SELECT &lt;dbid&gt;命令在redis-cli客户端切换数据库
databases 0

#指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合(redis是有机制将内存数据保存到硬盘的)
#Redis默认配置文件中提供了三个条件：
#save 900 1
#save 300 10
#save 60 10000
#分别表示900秒（15分钟）内有1个更改，300秒（5分钟）内有10个更改以及60秒内有10000个更改。
save &lt;seconds&gt; &lt;changes&gt;

#制定Redis存储本地数据库时是否压缩数据,默认yes.不启用的话会导致数据库文件很大
rdbcompression yes

#本地数据库文件名,默认dump.rdb
dbfilename dump.rdb

#本地数据库存放目录
dir ./

#设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步(在master-slave模式时启用)
slaveof &lt;masterip&gt; &lt;masterport&gt;

#master服务密码
masterauth &lt;master-password&gt;

#设置redis链接密码.客户端链接Reids时需要通过AUTH &lt;password&gt;指定,默认关闭
requirepass foobared

#设置同一时间内最大客户端连接数,默认没有限制.是否跟ulimit命令有关系
maxclients 128

#为Redis指定最大内存限制.达到最大内存后,开始清理已到期或即将到期的key.注意linux的swap分区.
maxmemory &lt;bytes&gt;

#是否在每次更新操作后进行日志记录,Redis在默认情况下是异步的把数据写入磁盘,如果不开启,可能会在断电时导致一段时间内的数据丢失.因为 redis本身同步数据文件是按上面save条件来同步的,所以有的数据会在一段时间内只存在于内存中.默认为no
appendonly no

#更新日志文件名，默认为appendonly.aof
appendfilename appendonly.aof

#日志更新条件
#no:等操作系统进行数据缓存同步到磁盘(快)
#always:每次更新操作后手动调用fsync()将数据写到磁盘(慢,安全)
#everysec:表示每秒同步一次(折中,默认值)
appendfsync everysec

#是否启用虚拟内存机制,默认值为no
vm-enabled no

#虚拟内存文件路径,默认值为/tmp/redis.swap,不可多个Redis实例共享
vm-swap-file /tmp/redis.swap

#将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据 就是keys),也就是说,当vm-max-memory设置为0的时候,其实是所有value都存在于磁盘。默认值为0
vm-max-memory 0

#Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的 数据大小来设定的，作者建议如果存储很多小对象，page大小最好设置为32或者64bytes；如果存储很大大对象，则可以使用更大的page，如果不 确定，就使用默认值
vm-page-size 32

#设置swap文件中的page数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每8个pages将消耗1byte的内存。
vm-pages 134217728

#设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为0,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为4
vm-max-threads 4

#设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启
glueoutputbuf yes

#指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法
hash-max-zipmap-entries 64
hash-max-zipmap-value 512

#指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）
activerehashing yes

#指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件
include /path/to/local.conf
</code></pre>
        </div>
      </li>
      <li>
        <p>关于vm开头的配置的说明</p>

        <p>redis从2.4版本之后取消了以vm开头的配置.</p>

        <blockquote>
          <p>The use of Virtual Memory is strongly discouraged.</p>
        </blockquote>
      </li>
      <li>
        <p>启动Redis服务端</p>

        <p><code class="highlighter-rouge">bash
cd xx/redis-3.2.3/src
</code></p>

        <p><code class="highlighter-rouge">bash
./redis-server
</code></p>
      </li>
      <li>
        <p>启动Redis客户端</p>

        <p><code class="highlighter-rouge">bash
cd xx/redis-3.2.3/src
</code></p>

        <p><code class="highlighter-rouge">bash
./redis-cli
</code></p>
      </li>
    </ul>
  </li>
</ul>

<h1 id="spring-boot-redis">Spring Boot 连接Redis</h1>

<ul>
  <li>
    <p>pom.xml</p>

    <div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
         <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>sunshineasbefore<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>redis<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;packaging&gt;</span>jar<span class="nt">&lt;/packaging&gt;</span>
  <span class="nt">&lt;name&gt;</span>redis<span class="nt">&lt;/name&gt;</span>
  <span class="nt">&lt;description&gt;</span>redis<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;parent&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.4.1.RELEASE<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;relativePath/&gt;</span> <span class="c">&lt;!-- lookup parent from repository --&gt;</span>
  <span class="nt">&lt;/parent&gt;</span>
  <span class="nt">&lt;properties&gt;</span>
    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.reporting.outputEncoding&gt;</span>
    <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
  <span class="nt">&lt;/properties&gt;</span>
  <span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
      <span class="nt">&lt;artifactId&gt;</span>spring-boot-devtools<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
      <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;/dependency&gt;</span>
     <span class="nt">&lt;dependency&gt;</span>
       <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
       <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
     <span class="nt">&lt;/dependency&gt;</span>
     <span class="nt">&lt;dependency&gt;</span>
       <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span class="nt">&lt;/artifactId&gt;</span>
     <span class="nt">&lt;/dependency&gt;</span>
     <span class="c">&lt;!-- https://mvnrepository.com/artifact/com.alibaba/fastjson --&gt;</span>
     <span class="nt">&lt;dependency&gt;</span>
       <span class="nt">&lt;groupId&gt;</span>com.alibaba<span class="nt">&lt;/groupId&gt;</span>
       <span class="nt">&lt;artifactId&gt;</span>fastjson<span class="nt">&lt;/artifactId&gt;</span>
       <span class="nt">&lt;version&gt;</span>1.2.17<span class="nt">&lt;/version&gt;</span>
     <span class="nt">&lt;/dependency&gt;</span>
   <span class="nt">&lt;/dependencies&gt;</span>
   <span class="nt">&lt;build&gt;</span>
     <span class="nt">&lt;plugins&gt;</span>
       <span class="nt">&lt;plugin&gt;</span>
         <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
         <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
       <span class="nt">&lt;/plugin&gt;</span>
     <span class="nt">&lt;/plugins&gt;</span>
   <span class="nt">&lt;/build&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre>
    </div>
  </li>
  <li>
    <p>application.properties</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>spring.cache.type=redis
spring.cache.cache-names=redis-test
# REDIS (RedisProperties)
# Database index used by the connection factory.
spring.redis.database=0
# server host
spring.redis.host=localhost
# server password
spring.redis.password=
# connection port
spring.redis.port=6379
# pool settings ...
spring.redis.pool.max-idle=8
spring.redis.pool.min-idle=0
spring.redis.pool.max-active=8
spring.redis.pool.max-wait=-1
spring.redis.timeout=10
# name of Redis server
#spring.redis.sentinel.master=
# comma-separated list of host:port pairs
#spring.redis.sentinel.nodes=
</code></pre>
    </div>
  </li>
  <li>
    <p>redis config</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>package redis;

import com.fasterxml.jackson.annotation.JsonAutoDetect;
import com.fasterxml.jackson.annotation.PropertyAccessor;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.cache.CacheManager;
import org.springframework.cache.annotation.CachingConfigurerSupport;
import org.springframework.cache.annotation.EnableCaching;
import org.springframework.cache.interceptor.KeyGenerator;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheManager;
import org.springframework.data.redis.connection.RedisConnectionFactory;
import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;
import redis.clients.jedis.JedisPoolConfig;

/**
 * 描述: TODO:
 * 包名: redis.
 * 作者: barton.
 * 日期: 16-9-24.
 * 项目名称: redis
 * 版本: 1.0
 * JDK: since 1.8
 */
@Configuration
@EnableCaching
public class RedisConfig extends CachingConfigurerSupport {

  @Value("${spring.redis.host}")
  private String host;
  @Value("${spring.redis.port}")
  private int port;
  @Value("${spring.redis.timeout}")
  private int timeout;

  /**
   * 对于key的生成,不能使用随机生成.
   * 第一次访问时会生成一个key值,如果redis中不存在,则将此key值和对应的value值放置在redis中,
   * 第二次访问时会再次根据一定条件生成key值,如果此key值在redis中存在,则直接取.
   * 也就是说对于一个特定的对象,它生成的key值一定是要唯一的.
   */
  @Bean
  public KeyGenerator keyGenerator() {
    return (target, method, params) -&gt; {
      StringBuilder sb = new StringBuilder();
      sb.append(target.getClass().getName());
      sb.append(method.getName());
      for (Object obj : params) {
        sb.append(obj.toString());
      }
      return sb.toString();
    };
  }

  @Bean
  public CacheManager cacheManager(RedisTemplate redisTemplate) {
    RedisCacheManager cacheManager = new RedisCacheManager(redisTemplate);
    // Number of seconds before expiration. Defaults to unlimited (0)
    cacheManager.setDefaultExpiration(10); //设置key-value超时时间
    return cacheManager;
  }

  @Bean
  public JedisConnectionFactory redisConnectionFactory() {
    JedisConnectionFactory factory = new JedisConnectionFactory();
    factory.setHostName(host);
    factory.setPort(port);
    factory.setTimeout(timeout); //设置连接超时时间
    factory.setUsePool(true);
    factory.setPoolConfig(jedisPoolConfig());
    return factory;
  }

  @Bean
  public RedisTemplate&lt;String, String&gt; redisTemplate(RedisConnectionFactory factory) {
    StringRedisTemplate template = new StringRedisTemplate(factory);
    Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
    ObjectMapper om = new ObjectMapper();
    om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
    om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
    jackson2JsonRedisSerializer.setObjectMapper(om);
    template.setValueSerializer(jackson2JsonRedisSerializer);
    template.afterPropertiesSet();
    return template;
  }

  @Bean
  public JedisPoolConfig jedisPoolConfig() {
    JedisPoolConfig jedisPoolConfig = new JedisPoolConfig();
    //    jedisPoolConfig.set ...
    return jedisPoolConfig;
  }
}
</code></pre>
    </div>
  </li>
  <li>
    <p>POJO对象</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>public class Student {
  public Student() {
  }

  public Student(String id, String name, int age) {
    this.id = id;
    this.name = name;
    this.age = age;
  }

  private String id;
  private String name;
  private int age;

  // 省略getter setter...
}
</code></pre>
    </div>
  </li>
  <li>
    <p>创建一个RedisService来获取数据</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>package redis;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.cache.annotation.Cacheable;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.stereotype.Service;

/**
 * 描述: TODO:
 * 包名: redis.
 * 作者: barton.
 * 日期: 16-9-24.
 * 项目名称: redis
 * 版本: 1.0
 * JDK: since 1.8
 */
@Service
public class RedisService {

  @Autowired
  private RedisTemplate&lt;String, String&gt; redisTemplate;

  // keyGenerator = "keyGenerator"注意结合Spring IOC/DI的概念.
  @Cacheable(value = "studentcache", keyGenerator = "keyGenerator")
  public Student getStudent(String id, String name, int age) {
    System.out.println("如果没有缓存,则会输出这一行内容!");
    return new Student(id, name, age);
  }
}
</code></pre>
    </div>
  </li>
  <li>
    <p>使用JUnit Test测试getStudent方法</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;

/**
 * 描述: TODO:
 * 包名: redis.
 * 作者: barton.
 * 日期: 16-9-24.
 * 项目名称: redis
 * 版本: 1.0
 * JDK: since 1.8
 */
@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest(classes = {RedisApplication.class})
public class RedisServiceTest {

  @Autowired
  private RedisService service;

  @Test
  public void testGetStudent() {
    System.out.println("第一次:");
    System.out.println(service.getStudent("1", "barton", 22));
    System.out.println("第二次:");
    System.out.println(service.getStudent("1", "barton", 22));
  }
}
</code></pre>
    </div>
  </li>
  <li>
    <p>输出结果</p>
    <ul>
      <li>
        <p>在首次运行时会输出:</p>

        <p><code class="highlighter-rouge">
第一次:
如果没有缓存,则会输出这一行内容!
redis.Student@6c5747db
第二次:
redis.Student@ba4f370
</code></p>
      </li>
      <li>
        <p>再次运行时会输出:</p>

        <p><code class="highlighter-rouge">
第一次:
redis.Student@1ffd0114
第二次:
redis.Student@b3857e2
</code></p>
      </li>
      <li>
        <p>解释:
再次运行时,redis中已经存在该对象的key了.所以两次都是从缓存中取得value值.</p>
      </li>
    </ul>

    <p>如果将redis停止后,再启动,其运行结果同再次运行时输出的结果.原因,redis会根据配置文件的相关配置将value值进行持久化,而不仅仅是存放在内存中,断电后就没有了.</p>
  </li>
</ul>

            </article>
        </div>
      </div>
      <div class="panel docs-content">
        <article class="post-content">
          <div class="wrapper">
            


  <div class="ds-thread" data-thread-key="/2016/10/12/%E5%9C%A8Spring-Boot%E4%B8%AD%E4%BD%BF%E7%94%A8Redis/" data-title="在Spring Boot中使用Redis" data-url="http://www.veryjava.cn/2016/10/12/%E5%9C%A8Spring-Boot%E4%B8%AD%E4%BD%BF%E7%94%A8Redis/"></div>

<script type="text/javascript">
var duoshuoQuery = {short_name:"ssab"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>


 
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

    
    <!-- UY BEGIN -->
<div class="container" style="padding-left:295px;" id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2112749"></script>
<!-- UY END -->
<footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2016 <a href=""><code>sunshineasbefore</code></a>.</p>
		<p>Powered by <a href="http://jekyllrb.com">Jekyll</a>, theme from <a href="http://lesscss.cn/">Less</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/lessismore.js"></script>


  </body>
</html>
